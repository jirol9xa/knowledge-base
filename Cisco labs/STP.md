Не забываем про [[Базовые фичи]].

Служит для подстраховки от разрыва канала. Т.е. в случае, если кто-то повредит нам соединение между коммутаторами, мы не должны потерять возможность передавать сообщения. 

STP (Spunning tree protocol) решает эту проблему. 

Алгоритм работы STP:
1) Выбирается корневой коммутатор
2) Выбирается корневой порт на некорневом коммутаторе (выбирается порт, с которого быстрее всего сообщение дойдет от нашего свича до корневого коммутатора, возможно путь будет проходить через другие коммутаторы).
3) Выбирается назначенный порт (выбирается на свиче, у которого самое быстрое соединение с корневым коммутатором). Назначенный порт выбирается на некорневых коммутаторах и работает в штатном режиме работы сети. То есть через него данные будут идти по-дефолту, пока соединение не будет прервано.

*Корневым коммутатором* становится коммутатор с наименьшим mac адресом. (Т.к. по умолчанию приоритет всех коммутаторов в cisco одинаковый)

Аналогичное правило наименьшего mac адреса действует и для портов, если другие условия совпадают.

Состояния портов:
* Блокировка (blocking)
* Прослушивание (listening)
* Обучение (learning)
* Передача (forwarding)

Основные команды:
* show spanning-tree
* spanning-tree vlan <номер vlan> priority 
* spanning-tree vlan <номер vlan> root primary
* spanning-tree mode rapid-pvst <--- включает rstp (время сходимости уменьшается на порядок)

##### В целом для включения обычного STP ничего делать не нужно, просто соединить коммутаторы.